# Testing Strategy for regular-calendar

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€`regular-calendar` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆæ–¹é‡ã‚’å®šç¾©ã—ã¾ã™ã€‚
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **React UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª** ã§ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ‡ãƒ¼ã‚¿å–å¾—ç­‰ï¼‰ã‚ˆã‚Šã‚‚ã€**è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã€æ“ä½œæ€§ã€ãŠã‚ˆã³Propsã¨ã—ã¦æ¸¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** ã®æ¤œè¨¼ã«é‡ç‚¹ã‚’ç½®ãã¾ã™ã€‚

## ğŸ¯ ãƒ†ã‚¹ãƒˆã®ç›®çš„
1. **ãƒ­ã‚¸ãƒƒã‚¯ã®æ­£ç¢ºæ€§**: è¤‡é›‘ãªã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ—¥ä»˜è¨ˆç®—ã€ã‚¤ãƒ™ãƒ³ãƒˆé…ç½®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰ã®æ‹…ä¿ã€‚
2. **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã®æ¤œè¨¼**: ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã€ãƒªã‚µã‚¤ã‚ºã€ãƒ¢ãƒ¼ãƒ€ãƒ«æ“ä½œãªã©ã®UIå‹•ä½œç¢ºèªã€‚
3. **ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³é˜²æ­¢**: UIå¤‰æ›´æ™‚ã®æ„å›³ã—ãªã„ç ´å£Šã‚’é˜²ãã€‚

## ğŸ“‚ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½® (Co-location)

ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**ã«é…ç½®ã—ã¾ã™ï¼ˆCo-locationï¼‰ã€‚
æ©Ÿèƒ½ã”ã¨ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒåˆ‡ã‚‰ã‚Œã¦ã„ã‚‹ç¾åœ¨ã®æ§‹é€ ã«å¾“ã„ã€é–¢é€£ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ã‚¹ãƒˆã‚’è¿‘ãã«ä¿ã¡ã¾ã™ã€‚

```text
src/
  FacilitySchedule/
    components/
      TimelineEvent.tsx
      TimelineEvent.test.tsx      âœ… ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
    utils/
      layout-algorithm.ts
      layout-algorithm.test.ts    âœ… ãƒ­ã‚¸ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
    FacilitySchedule.tsx
    FacilitySchedule.test.tsx     âœ… çµ±åˆçš„ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
```

> ğŸš« **ç¦æ­¢**: `src/Test/` ã‚„ `__tests__` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¾ã¨ã‚ã¦ãƒ†ã‚¹ãƒˆã‚’é…ç½®ã™ã‚‹ã“ã¨ã¯é¿ã‘ã¦ãã ã•ã„ã€‚

## ğŸ§ª ãƒ†ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒªã¨æŒ‡é‡

### 1. ãƒ­ã‚¸ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ (Unit Test)
ç´”ç²‹ãªé–¢æ•°ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã®ãƒ†ã‚¹ãƒˆã€‚
ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦æœ€ã‚‚é‡è¦ãªã€Œæ­£ã—ã„ä½ç½®ã«ã‚¤ãƒ™ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ã€ã®è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã¯ã“ã“ã§åšããƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

- **å¯¾è±¡**: `src/**/utils/*.ts`, `src/hooks/*.ts`
- **ãƒ„ãƒ¼ãƒ«**: Vitest
- **é‡ç‚¹é …ç›®**:
  - æ—¥ä»˜ãƒ»æ™‚é–“ã®è¨ˆç®— (Boundary values)
  - ã‚¤ãƒ™ãƒ³ãƒˆã®é‡ãªã‚Šåˆ¤å®šãƒ»é…ç½®è¨ˆç®—
  - ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ (`*.schema.ts`)

```typescript
// utils/layout.test.ts
import { calculateEventPosition } from './layout';

it('should calculate correct position for 10:00 event', () => {
  const result = calculateEventPosition('10:00', '12:00');
  expect(result.top).toBe(100);
  expect(result.height).toBe(50);
});
```

### 2. UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ (Component Test)
Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã®ãƒ†ã‚¹ãƒˆã€‚
æœ¬ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã‚’æŒãŸãšã€**Propsé§†å‹•**ã§ã‚ã‚‹ãŸã‚ã€æ§˜ã€…ãªPropsãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾ã™ã‚‹è¡¨ç¤ºçµæœã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

- **å¯¾è±¡**: `*.tsx`
- **ãƒ„ãƒ¼ãƒ«**: React Testing Library, `@testing-library/user-event`
- **é‡ç‚¹é …ç›®**:
  - Propsã§æ¸¡ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãŒæ­£ã—ãæç”»ã•ã‚Œã‚‹ã‹
  - ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ï¼ˆonClick, onDropãªã©ï¼‰ãŒæ­£ã—ãç™ºç«ã™ã‚‹ã‹
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼ˆã‚¯ãƒªãƒƒã‚¯ã€ãƒ‰ãƒ©ãƒƒã‚°ï¼‰ã¸ã®å¿œç­”

```typescript
// components/EventCard.test.tsx
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { EventCard } from './EventCard';

it('calls onClick when clicked', async () => {
  const handleClick = vi.fn();
  const user = userEvent.setup();
  
  render(<EventCard title="Test Event" onClick={handleClick} />);
  
  await user.click(screen.getByText('Test Event'));
  expect(handleClick).toHaveBeenCalledTimes(1);
});
```

## ï¿½ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç’°å¢ƒ

### æ¨å¥¨ã‚³ãƒãƒ³ãƒ‰
- `pnpm test`: å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
- `pnpm test:ui`: Vitest UIã‚’ä½¿ç”¨ã—ãŸè¦–è¦šçš„ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
- `pnpm test -- [filename]`: ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- `pnpm test:coverage`: ã‚«ãƒãƒ¬ãƒƒã‚¸ã®ç¢ºèªã€‚å®Ÿè£…ãŒã€Œã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã€ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™ã€‚

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- `src/test/setup.ts` ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªè¨­å®šï¼ˆjest-domã®æ‹¡å¼µãªã©ï¼‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
- `jsdom` ç’°å¢ƒã§å‹•ä½œã—ã¾ã™ã€‚Web APIï¼ˆCanvasã‚„ResizeObserverãªã©ï¼‰ãŒå¿…è¦ãªå ´åˆã¯ã€é©å®œMockã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

## ğŸ“ ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ (ãƒ†ã‚¹ãƒˆ)

1.  **Describe Block**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåã‚„æ¤œè¨¼å¯¾è±¡ã®æ©Ÿèƒ½åã§ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã™ã‚‹ã€‚
2.  **Test Description (`it`/`test`)**: ã€Œä½•ã‚’ã—ãŸã‚‰(Given/When)ã€ã€Œã©ã†ãªã‚‹ã¹ãã‹(Then)ã€ãŒåˆ†ã‹ã‚‹ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã€‚æ—¥æœ¬èªã§ã®è¨˜è¿°ã‚‚å¯ã¨ã™ã‚‹ã€‚
3.  **Mocking**:
    - å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆ`dnd-kit`ã‚„`date-fns`ãªã©ï¼‰ã®ãƒ¢ãƒƒã‚¯ã¯å¿…è¦æœ€å°é™ã«ç•™ã‚ã‚‹ã€‚
    - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ¸¡ã™ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯ `vi.fn()` ã§ãƒ¢ãƒƒã‚¯ã—ã€å‘¼ã³å‡ºã—ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
4.  **Snapshots**:
    - å¤§è¦æ¨¡ãªã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¯å£Šã‚Œã‚„ã™ã„ãŸã‚æ¨å¥¨ã—ã¾ã›ã‚“ã€‚
    - å¤‰åŒ–ã—ã¦ã¯ã„ã‘ãªã„é‡è¦ãªDOMæ§‹é€ ã‚„ã€è¨ˆç®—çµæœã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ã®ã¿é™å®šçš„ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

## ğŸ¯ ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ã®å“è³ªã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ç›®æ¨™ã‚’è¨­å®šã—ã¾ã™ã€‚

- **ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆUtils/Hooksï¼‰**: 100%
  - è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã€ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã€ãƒ•ãƒƒã‚¯ã®çŠ¶æ…‹é·ç§»ã¯å®Œå…¨ã«ã‚«ãƒãƒ¼ã™ã‚‹ã€‚
- **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: 80%ä»¥ä¸Š
  - å…¨ã¦ã®Propsãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã€æ¡ä»¶åˆ†å²ã‚’ã‚«ãƒãƒ¼ã™ã‚‹ã€‚
  - ã‚¹ã‚¿ã‚¤ãƒ«ã‚„ç´°ã‹ãªè¡¨ç¤ºã®å·®ç•°ãƒ†ã‚¹ãƒˆã¯ã‚³ã‚¹ãƒˆå¯¾åŠ¹æœã‚’è€ƒæ…®ã™ã‚‹ã€‚

## ğŸ’¡ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### 1. ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å•é¡Œ
ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ†ã‚¹ãƒˆã§ã¯ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ãŒåŸå› ã§å¤±æ•—ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã¯å¸¸ã«UTCã¾ãŸã¯å›ºå®šã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```typescript
beforeEach(() => {
  // ãƒ†ã‚¹ãƒˆä¸­ã¯ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’å›ºå®š
  vi.setSystemTime(new Date('2025-01-01T10:00:00Z'));
});

afterEach(() => {
  vi.useRealTimers();
});
```

### 2. éåŒæœŸå‡¦ç†ã¨ã‚¿ã‚¤ãƒãƒ¼
ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã‚„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å«ã‚€æ“ä½œã®ãƒ†ã‚¹ãƒˆã«ã¯ã€éåŒæœŸãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚„ãƒ•ã‚§ã‚¤ã‚¯ã‚¿ã‚¤ãƒãƒ¼ã‚’æ´»ç”¨ã—ã¾ã™ã€‚

```typescript
// ã‚¿ã‚¤ãƒãƒ¼å¾…ã¡ãŒå¿…è¦ãªå ´åˆ
vi.useFakeTimers();
// ...æ“ä½œ...
vi.advanceTimersByTime(100);
```

### 3. ãƒ¢ãƒƒã‚¯ã®æ´»ç”¨
å¤–éƒ¨ä¾å­˜ï¼ˆæ—¥ä»˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã©ï¼‰ã‚„ãƒ–ãƒ©ã‚¦ã‚¶APIï¼ˆLocalStorage, ResizeObserverï¼‰ã¯é©åˆ‡ã«ãƒ¢ãƒƒã‚¯ã—ã¾ã™ã€‚

```typescript
// LocalStorageã®ãƒ¢ãƒƒã‚¯ä¾‹
const localStorageMock = {
    getItem: vi.fn(),
    setItem: vi.fn(),
    clear: vi.fn(),
};
vi.stubGlobal('localStorage', localStorageMock);
```

